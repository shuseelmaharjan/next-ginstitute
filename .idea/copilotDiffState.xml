<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/login/page.tsx">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/login/page.tsx" />
              <option name="originalContent" value="&quot;use client&quot;;&#10;&#10;import { useState, useEffect } from &quot;react&quot;;&#10;import { Input } from &quot;@/components/ui/input&quot;;&#10;import { Button } from &quot;@/components/ui/button&quot;;&#10;import { Label } from &quot;@/components/ui/label&quot;;&#10;import Link from &quot;next/link&quot;;&#10;import { motion } from &quot;framer-motion&quot;;&#10;import { useRouter } from &quot;next/navigation&quot;;&#10;import { Alert, AlertDescription, AlertTitle } from &quot;@/components/ui/alert&quot;;&#10;import apiClient from &quot;../api/apiClient&quot;;&#10;import { useAuthenticate } from &quot;@/app/context/AuthenticateContext&quot;;&#10;&#10;&#10;export default function LoginPage() {&#10;    const [form, setForm] = useState({ username: &quot;&quot;, password: &quot;&quot; });&#10;    const [isHovered, setIsHovered] = useState(false);&#10;    const [errorMsg, setErrorMsg] = useState(&quot;&quot;);&#10;    const router = useRouter();&#10;    const { isAuthenticated } = useAuthenticate();&#10;&#10;    // if already authenticated (or session flag exists), redirect away from login&#10;    useEffect(() =&gt; {&#10;        if (typeof window !== 'undefined') {&#10;            const hasSession = !!(sessionStorage.getItem('session') || sessionStorage.getItem('user'));&#10;            if (hasSession || isAuthenticated) {&#10;                router.replace('/dashboard');&#10;            }&#10;        }&#10;    }, [isAuthenticated, router]);&#10;&#10;    const handleChange = (e: React.ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {&#10;        setForm({ ...form, [e.target.name]: e.target.value });&#10;    };&#10;&#10;    const handleSubmit = async (e: React.FormEvent) =&gt; {&#10;        e.preventDefault();&#10;        setErrorMsg(&quot;&quot;);&#10;&#10;        try {&#10;            type LoginResponse = {&#10;                success: boolean;&#10;                message?: string;&#10;                data?: {&#10;                    user?: {&#10;                        id: number;&#10;                        username: string;&#10;                        email: string;&#10;                        name: string;&#10;                        role: string;&#10;                        isActive: boolean;&#10;                        profilePicture?: string;&#10;                    };&#10;                    accessToken?: string;&#10;                };&#10;            };&#10;&#10;            const res = await apiClient&lt;LoginResponse&gt;({&#10;                url: &quot;/api/auth/login&quot;,&#10;                method: &quot;POST&quot;,&#10;                data: {&#10;                    identifier: form.username,&#10;                    password: form.password,&#10;                },&#10;                headers: {&#10;                    &quot;X-Client-Type&quot;: &quot;web&quot;,&#10;                },&#10;            }) as LoginResponse;&#10;&#10;            if (res &amp;&amp; res.success) {&#10;                if (typeof window !== &quot;undefined&quot; &amp;&amp; res.data &amp;&amp; res.data.user) {&#10;                    sessionStorage.setItem(&quot;user&quot;, JSON.stringify(res.data.user));&#10;                    try { sessionStorage.setItem('session', 'true'); } catch {}&#10;                }&#10;                // using replace + reload to avoid leaving login in history&#10;                router.replace(&quot;/dashboard&quot;);&#10;                // ensure a single reload after navigation&#10;                setTimeout(() =&gt; window.location.reload(), 100);&#10;            } else {&#10;                setErrorMsg(res?.message || &quot;Login failed&quot;);&#10;            }&#10;        } catch (err: unknown) {&#10;            // Safely extract message from unknown&#10;            let msg = &quot;An unexpected error occurred&quot;;&#10;            if (typeof err === 'object' &amp;&amp; err !== null) {&#10;                const e = err as Record&lt;string, unknown&gt;;&#10;                if (typeof e['message'] === 'string') msg = e['message'] as string;&#10;            }&#10;            setErrorMsg(msg);&#10;        }&#10;    };&#10;&#10;    return (&#10;        &lt;div className=&quot;min-h-screen flex items-center justify-center bg-amber-50 px-4 py-12&quot;&gt;&#10;            &lt;motion.div&#10;                initial={{ opacity: 0, y: 20 }}&#10;                animate={{ opacity: 1, y: 0 }}&#10;                transition={{ duration: 0.5 }}&#10;                className=&quot;w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden&quot;&#10;            &gt;&#10;                {/* Decorative Header */}&#10;                &lt;div className=&quot;relative h-24 bg-primary-color&quot;&gt;&#10;                    &lt;div className=&quot;absolute inset-0 flex items-center justify-center&quot;&gt;&#10;                        &lt;div className=&quot;bg-white p-2 rounded-full shadow-lg&quot;&gt;&#10;                            &lt;img&#10;                                src=&quot;/images/main.png&quot;&#10;                                alt=&quot;logo&quot;&#10;                                className=&quot;w-16 h-16 object-contain&quot;&#10;                            /&gt;&#10;                        &lt;/div&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;&#10;                &lt;div className=&quot;px-8 pb-8 pt-8 space-y-4&quot;&gt;&#10;                    &lt;div className=&quot;text-center&quot;&gt;&#10;                        &lt;h1 className=&quot;text-3xl font-bold text-gray-800 mb-1&quot;&gt;Golden Future Institute&lt;/h1&gt;&#10;                        &lt;p className=&quot;text-gray-500&quot;&gt;Sign in to continue to your account&lt;/p&gt;&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;form className=&quot;space-y-5&quot; onSubmit={handleSubmit}&gt;&#10;                        &lt;div&gt;&#10;                            &lt;Label htmlFor=&quot;username&quot; className=&quot;text-sm font-medium text-gray-700 mb-2 block&quot;&gt;&#10;                                Username or Email&#10;                            &lt;/Label&gt;&#10;                            &lt;Input&#10;                                id=&quot;username&quot;&#10;                                name=&quot;username&quot;&#10;                                type=&quot;text&quot;&#10;                                placeholder=&quot;Enter your username or email&quot;&#10;                                value={form.username}&#10;                                onChange={handleChange}&#10;                                required&#10;                                className=&quot;py-5 px-4 text-base rounded border-gray-300 focus:border-indigo-500 focus:ring-indigo-500&quot;&#10;                            /&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;div&gt;&#10;                            &lt;div className=&quot;flex justify-between items-center mb-2&quot;&gt;&#10;                                &lt;Label htmlFor=&quot;password&quot; className=&quot;text-sm font-medium text-gray-700&quot;&gt;&#10;                                    Password&#10;                                &lt;/Label&gt;&#10;                            &lt;/div&gt;&#10;                            &lt;Input&#10;                                id=&quot;password&quot;&#10;                                name=&quot;password&quot;&#10;                                type=&quot;password&quot;&#10;                                placeholder=&quot;Enter your password&quot;&#10;                                value={form.password}&#10;                                onChange={handleChange}&#10;                                required&#10;                                className=&quot;py-5 px-4 text-base rounded border-gray-300 focus:border-indigo-500 focus:ring-indigo-500&quot;&#10;                            /&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;div className=&quot;flex justify-between items-center&quot;&gt;&#10;                            &lt;div className=&quot;flex items-center&quot;&gt;&#10;                                &lt;input&#10;                                    id=&quot;remember-me&quot;&#10;                                    name=&quot;remember-me&quot;&#10;                                    type=&quot;checkbox&quot;&#10;                                    className=&quot;h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500&quot;&#10;                                /&gt;&#10;                                &lt;label htmlFor=&quot;remember-me&quot; className=&quot;ml-2 block text-sm text-gray-700&quot;&gt;&#10;                                    Remember me&#10;                                &lt;/label&gt;&#10;                            &lt;/div&gt;&#10;                            &lt;Link href=&quot;/forgot-password&quot; className=&quot;text-xs text-primary-color hover:underline font-medium&quot;&gt;&#10;                                Forgot password?&#10;                            &lt;/Link&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;motion.div&#10;                            whileHover={{ scale: 1.01 }}&#10;                            whileTap={{ scale: 0.99 }}&#10;                        &gt;&#10;                            &lt;Button&#10;                                type=&quot;submit&quot;&#10;                                className=&quot;w-full bg-primary-color hover:bg-blue-600 text-white font-bold py-5 rounded-xl shadow-lg transition-all duration-300 relative overflow-hidden cursor-pointer select-none&quot;&#10;                                onMouseEnter={() =&gt; setIsHovered(true)}&#10;                                onMouseLeave={() =&gt; setIsHovered(false)}&#10;                            &gt;&#10;                                &lt;span className=&quot;relative z-10&quot;&gt;Login&lt;/span&gt;&#10;                                {isHovered &amp;&amp; (&#10;                                    &lt;motion.div&#10;                                        className=&quot;absolute inset-0 bg-white opacity-20&quot;&#10;                                        initial={{ x: &quot;-100%&quot; }}&#10;                                        animate={{ x: &quot;100%&quot; }}&#10;                                        transition={{ duration: 0.6 }}&#10;                                    /&gt;&#10;                                )}&#10;                            &lt;/Button&gt;&#10;                        &lt;/motion.div&gt;&#10;                    &lt;/form&gt;&#10;                    {errorMsg &amp;&amp; (&#10;                        &lt;Alert variant=&quot;destructive&quot; className=&quot;mt-4&quot;&gt;&#10;                            &lt;AlertTitle&gt;Error&lt;/AlertTitle&gt;&#10;                            &lt;AlertDescription&gt;{errorMsg}&lt;/AlertDescription&gt;&#10;                        &lt;/Alert&gt;&#10;                    )}&#10;&#10;&#10;                    &lt;div className=&quot;text-center text-sm text-gray-500 pt-4&quot;&gt;&#10;                        Back to{&quot; &quot;}&#10;                        &lt;Link href=&quot;/&quot; className=&quot;text-primary-color hover:underline font-semibold&quot;&gt;&#10;                            Homepage&#10;                        &lt;/Link&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/motion.div&gt;&#10;        &lt;/div&gt;&#10;    );&#10;}" />
              <option name="updatedContent" value="&quot;use client&quot;;&#10;&#10;import { useState, useEffect } from &quot;react&quot;;&#10;import { Input } from &quot;@/components/ui/input&quot;;&#10;import { Button } from &quot;@/components/ui/button&quot;;&#10;import { Label } from &quot;@/components/ui/label&quot;;&#10;import Link from &quot;next/link&quot;;&#10;import { motion } from &quot;framer-motion&quot;;&#10;import { useRouter } from &quot;next/navigation&quot;;&#10;import { Alert, AlertDescription, AlertTitle } from &quot;@/components/ui/alert&quot;;&#10;import apiClient from &quot;../api/apiClient&quot;;&#10;import { useAuthenticate } from &quot;@/app/context/AuthenticateContext&quot;;&#10;&#10;&#10;export default function LoginPage() {&#10;    const [form, setForm] = useState({ username: &quot;&quot;, password: &quot;&quot; });&#10;    const [isHovered, setIsHovered] = useState(false);&#10;    const [errorMsg, setErrorMsg] = useState(&quot;&quot;);&#10;    const router = useRouter();&#10;    const { isAuthenticated, refreshUser } = useAuthenticate();&#10;&#10;    // if already authenticated (or session flag exists), redirect away from login&#10;    useEffect(() =&gt; {&#10;        if (typeof window !== 'undefined') {&#10;            const hasSession = !!(sessionStorage.getItem('session') || sessionStorage.getItem('user'));&#10;            if (hasSession || isAuthenticated) {&#10;                router.replace('/dashboard');&#10;            }&#10;        }&#10;    }, [isAuthenticated, router]);&#10;&#10;    const handleChange = (e: React.ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {&#10;        setForm({ ...form, [e.target.name]: e.target.value });&#10;    };&#10;&#10;    const handleSubmit = async (e: React.FormEvent) =&gt; {&#10;        e.preventDefault();&#10;        setErrorMsg(&quot;&quot;);&#10;&#10;        try {&#10;            type LoginResponse = {&#10;                success: boolean;&#10;                message?: string;&#10;                data?: {&#10;                    user?: {&#10;                        id: number;&#10;                        username: string;&#10;                        email: string;&#10;                        name: string;&#10;                        role: string;&#10;                        isActive: boolean;&#10;                        profilePicture?: string;&#10;                    };&#10;                    accessToken?: string;&#10;                };&#10;            };&#10;&#10;            const res = await apiClient&lt;LoginResponse&gt;({&#10;                url: &quot;/api/auth/login&quot;,&#10;                method: &quot;POST&quot;,&#10;                data: {&#10;                    identifier: form.username,&#10;                    password: form.password,&#10;                },&#10;                headers: {&#10;                    &quot;X-Client-Type&quot;: &quot;web&quot;,&#10;                },&#10;            }) as LoginResponse;&#10;&#10;            if (res &amp;&amp; res.success) {&#10;                if (typeof window !== &quot;undefined&quot; &amp;&amp; res.data &amp;&amp; res.data.user) {&#10;                    sessionStorage.setItem(&quot;user&quot;, JSON.stringify(res.data.user));&#10;                    try { sessionStorage.setItem('session', 'true'); } catch {}&#10;                }&#10;                &#10;                // Refresh the authentication context to update isAuthenticated state&#10;                await refreshUser();&#10;                &#10;                // Navigate to dashboard - context should now be updated&#10;                router.replace(&quot;/dashboard&quot;);&#10;            } else {&#10;                setErrorMsg(res?.message || &quot;Login failed&quot;);&#10;            }&#10;        } catch (err: unknown) {&#10;            // Safely extract message from unknown&#10;            let msg = &quot;An unexpected error occurred&quot;;&#10;            if (typeof err === 'object' &amp;&amp; err !== null) {&#10;                const e = err as Record&lt;string, unknown&gt;;&#10;                if (typeof e['message'] === 'string') msg = e['message'] as string;&#10;            }&#10;            setErrorMsg(msg);&#10;        }&#10;    };&#10;&#10;    return (&#10;        &lt;div className=&quot;min-h-screen flex items-center justify-center bg-amber-50 px-4 py-12&quot;&gt;&#10;            &lt;motion.div&#10;                initial={{ opacity: 0, y: 20 }}&#10;                animate={{ opacity: 1, y: 0 }}&#10;                transition={{ duration: 0.5 }}&#10;                className=&quot;w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden&quot;&#10;            &gt;&#10;                {/* Decorative Header */}&#10;                &lt;div className=&quot;relative h-24 bg-primary-color&quot;&gt;&#10;                    &lt;div className=&quot;absolute inset-0 flex items-center justify-center&quot;&gt;&#10;                        &lt;div className=&quot;bg-white p-2 rounded-full shadow-lg&quot;&gt;&#10;                            &lt;img&#10;                                src=&quot;/images/main.png&quot;&#10;                                alt=&quot;logo&quot;&#10;                                className=&quot;w-16 h-16 object-contain&quot;&#10;                            /&gt;&#10;                        &lt;/div&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;&#10;                &lt;div className=&quot;px-8 pb-8 pt-8 space-y-4&quot;&gt;&#10;                    &lt;div className=&quot;text-center&quot;&gt;&#10;                        &lt;h1 className=&quot;text-3xl font-bold text-gray-800 mb-1&quot;&gt;Golden Future Institute&lt;/h1&gt;&#10;                        &lt;p className=&quot;text-gray-500&quot;&gt;Sign in to continue to your account&lt;/p&gt;&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;form className=&quot;space-y-5&quot; onSubmit={handleSubmit}&gt;&#10;                        &lt;div&gt;&#10;                            &lt;Label htmlFor=&quot;username&quot; className=&quot;text-sm font-medium text-gray-700 mb-2 block&quot;&gt;&#10;                                Username or Email&#10;                            &lt;/Label&gt;&#10;                            &lt;Input&#10;                                id=&quot;username&quot;&#10;                                name=&quot;username&quot;&#10;                                type=&quot;text&quot;&#10;                                placeholder=&quot;Enter your username or email&quot;&#10;                                value={form.username}&#10;                                onChange={handleChange}&#10;                                required&#10;                                className=&quot;py-5 px-4 text-base rounded border-gray-300 focus:border-indigo-500 focus:ring-indigo-500&quot;&#10;                            /&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;div&gt;&#10;                            &lt;div className=&quot;flex justify-between items-center mb-2&quot;&gt;&#10;                                &lt;Label htmlFor=&quot;password&quot; className=&quot;text-sm font-medium text-gray-700&quot;&gt;&#10;                                    Password&#10;                                &lt;/Label&gt;&#10;                            &lt;/div&gt;&#10;                            &lt;Input&#10;                                id=&quot;password&quot;&#10;                                name=&quot;password&quot;&#10;                                type=&quot;password&quot;&#10;                                placeholder=&quot;Enter your password&quot;&#10;                                value={form.password}&#10;                                onChange={handleChange}&#10;                                required&#10;                                className=&quot;py-5 px-4 text-base rounded border-gray-300 focus:border-indigo-500 focus:ring-indigo-500&quot;&#10;                            /&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;div className=&quot;flex justify-between items-center&quot;&gt;&#10;                            &lt;div className=&quot;flex items-center&quot;&gt;&#10;                                &lt;input&#10;                                    id=&quot;remember-me&quot;&#10;                                    name=&quot;remember-me&quot;&#10;                                    type=&quot;checkbox&quot;&#10;                                    className=&quot;h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500&quot;&#10;                                /&gt;&#10;                                &lt;label htmlFor=&quot;remember-me&quot; className=&quot;ml-2 block text-sm text-gray-700&quot;&gt;&#10;                                    Remember me&#10;                                &lt;/label&gt;&#10;                            &lt;/div&gt;&#10;                            &lt;Link href=&quot;/forgot-password&quot; className=&quot;text-xs text-primary-color hover:underline font-medium&quot;&gt;&#10;                                Forgot password?&#10;                            &lt;/Link&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;motion.div&#10;                            whileHover={{ scale: 1.01 }}&#10;                            whileTap={{ scale: 0.99 }}&#10;                        &gt;&#10;                            &lt;Button&#10;                                type=&quot;submit&quot;&#10;                                className=&quot;w-full bg-primary-color hover:bg-blue-600 text-white font-bold py-5 rounded-xl shadow-lg transition-all duration-300 relative overflow-hidden cursor-pointer select-none&quot;&#10;                                onMouseEnter={() =&gt; setIsHovered(true)}&#10;                                onMouseLeave={() =&gt; setIsHovered(false)}&#10;                            &gt;&#10;                                &lt;span className=&quot;relative z-10&quot;&gt;Login&lt;/span&gt;&#10;                                {isHovered &amp;&amp; (&#10;                                    &lt;motion.div&#10;                                        className=&quot;absolute inset-0 bg-white opacity-20&quot;&#10;                                        initial={{ x: &quot;-100%&quot; }}&#10;                                        animate={{ x: &quot;100%&quot; }}&#10;                                        transition={{ duration: 0.6 }}&#10;                                    /&gt;&#10;                                )}&#10;                            &lt;/Button&gt;&#10;                        &lt;/motion.div&gt;&#10;                    &lt;/form&gt;&#10;                    {errorMsg &amp;&amp; (&#10;                        &lt;Alert variant=&quot;destructive&quot; className=&quot;mt-4&quot;&gt;&#10;                            &lt;AlertTitle&gt;Error&lt;/AlertTitle&gt;&#10;                            &lt;AlertDescription&gt;{errorMsg}&lt;/AlertDescription&gt;&#10;                        &lt;/Alert&gt;&#10;                    )}&#10;&#10;&#10;                    &lt;div className=&quot;text-center text-sm text-gray-500 pt-4&quot;&gt;&#10;                        Back to{&quot; &quot;}&#10;                        &lt;Link href=&quot;/&quot; className=&quot;text-primary-color hover:underline font-semibold&quot;&gt;&#10;                            Homepage&#10;                        &lt;/Link&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/motion.div&gt;&#10;        &lt;/div&gt;&#10;    );&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>